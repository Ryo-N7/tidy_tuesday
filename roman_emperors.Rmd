---
title: "Untitled"
author: "RN7"
date: "8/13/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
pacman::p_load(dplyr, purrr, tidyr, ggplot2, ggtext, hrbrthemes, extrafont, 
               ggalt, ggforce, scales, ggrepel, forcats,
               ggthemes, dutchmasters, ochRe)

loadfonts(quiet = TRUE, device = "win")
```



  rise and fall of roman emperors
  
  
  gantt chart <>  ?
  bump chart
  beeswarm plot
  ggupset >>> rise - fall pairs
  
  ggtext color text
  
  x-axis year?
  facet_lump the "other" categories
  
  theme_solarized + greys

```{r}
emperors_raw <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-08-13/emperors.csv")

glimpse(emperors_raw)
```


```{r}
emperors_raw %>% count(rise, sort = TRUE)
```



```{r}
emperors_raw %>% count(cause, sort = TRUE)
```


```{r}
emperors_clean <- emperors_raw %>% 
  select(-verif_who) %>% 
  mutate(rise = fct_relevel(rise, "Birthright", "Appointment by Emperor",
                            "Appointment by Senate", "Election", 
                            "Appointment by Praetorian Guard",
                            "Appointment by Army",
                            "Purchase", "Seized Power"),
         dynasty = case_when(
           name %in% c("Trajan Decius", "Hostilian", 
                       "Trebonianus Gallus", "Aemilian") ~ "Decian",
           name %in% c("Valerian", "Gallienus") ~ "Valerian",
           name %in% c("Cladius Gothicus", "Quintillus", 
                       "Aurelian") ~ "Gordian (cont.)",
           name %in% c("Tacitus", "Florianus", "Probus") ~ "Tacitus",
           name %in% c("Carus", "Numerian", "Carinus") ~ "Caran",
           TRUE ~ dynasty)) %>% 
  mutate(dynasty = fct)
```

green for peaceful, red for violent

ochRe::emu_woman_paired

ggsci::default_igv

dutchmasters::milkmaid

```{r, fig.width=15}
emperors_clean %>% 
  filter(index <= 49) %>% 
  ggplot(aes(x = index, y = rise, group = 1)) +
  geom_path() +
  geom_point(aes(fill = dynasty),
             size = 5.5, shape = 21, stroke = 2) + 
  scale_x_discrete(expand = c(0.025, 0)) +
  scale_y_discrete(limits = rev(levels(emperors_clean$rise))) +
  scale_fill_dutchmasters(palette = "milkmaid") +
  labs(title = "Rise of Roman Emperors",
       subtitle = glue::glue("
                             From Augustus (26 B.C. - 14 A.D.) to Diocletian (379 A.D. - 395 A.D.)
                             Transition of Power Ordered by 'Peaceful' to 'Violent' *"),
       x = "Time: 26 B.C. - 395 A.D.", y = NULL,
       caption = glue::glue("* Subjective and with many caveats")) +
  theme_solarized() +
  theme(plot.title = element_text(size = 25),
        plot.subtitle = element_text(size = 20),
        text = element_text(size = 16),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank())
```




```{r, fig.width=15}
emperors_clean %>% 
  filter(index <= 49) %>% 
  ggplot(aes(x = index, y = cause, group = 1)) +
  geom_point(aes(color = dynasty),
             size = 3.5) + 
  geom_path() +
  scale_y_discrete(limits = rev(levels(emperors_clean$cause))) +
  labs(title = "Fall of Roman Emperors",
       subtitle = glue::glue("
                             From Augustus (26 B.C. - 14 A.D.) to Diocletian (379 A.D. - 395 A.D.)
                             Transition of Power Ordered by Peaceful to Violent (*Subjective)"),
       x = "Time: 26 B.C. - 395 A.D.", y = NULL) +
  theme_solarized()
```